{"ast":null,"code":"import _toConsumableArray from \"/Users/God/Desktop/github/Port/portfolio/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"/Users/God/Desktop/github/Port/portfolio/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/God/Desktop/github/Port/portfolio/client/src/pages/Chat/Chat.js\";\nimport React, { Fragment, useEffect } from 'react';\nimport SideBar from './SideBar';\nimport ChatHeading from './chatHeading';\n\nfunction Chat(props) {\n  var _this = this;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      chat = _useState2[0],\n      setChat = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      activeChat = _useState4[0],\n      setActiveChat = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      loaded = _useState6[0],\n      setLoaded = _useState6[1];\n\n  useEffect(function () {\n    if (!loaded) {\n      setLoaded(true);\n      var socket = props.socket;\n      socket.emit(COMMUNITY_CHAT, resetChat);\n    }\n  });\n\n  function resetChat(chat) {\n    return addChat(chat, true);\n  }\n\n  function addChat(chat, reset) {\n    var socket = props.socket;\n    var newChats = reset ? [chat] : [].concat(_toConsumableArray(chats), [chat]);\n    setChats({\n      chats: newChats\n    });\n    setActiveChat({\n      activeChat: reset ? chat : activeChat\n    });\n    var messageEvent = \"\".concat(MESSAGE_RECIEVED, \"=\").concat(chat.id);\n    var typingEvent = \"\".concat(TYPING, \"=\").concat(chat.id);\n    socket.on(typingEvent, updateTypingChat(chat.id));\n    socket.on(messageEvent, addMessageToChat(chat.id));\n  }\n\n  function addMessageToChat(chatId) {\n    return function (message) {\n      var newChats = chats.map(function (chat) {\n        if (chat.id === chatId) {\n          chat.messages.push(message);\n        }\n\n        return chat;\n      });\n      setChats({\n        chats: newChats\n      });\n    };\n  }\n\n  function updateTypingChat(chatId) {\n    return function (_ref) {\n      var isTyping = _ref.isTyping,\n          user = _ref.user;\n\n      if (user !== props.user.name) {\n        var newChats = chats.map(function (chat) {\n          if (chat.id === chatId) {\n            if (isTyping && !chat.typingUsers.includes(user)) {\n              chat.typingUsers.push(user);\n            } else if (!isTyping && chat.typingUser.includes(user)) {\n              chat.typingUsers = chat.typingUsers.filter(function (u) {\n                return u !== user;\n              });\n            }\n          }\n\n          return chat;\n        });\n        setChats({\n          chats: newChats\n        });\n      }\n    };\n  }\n\n  function sendTyping(chatId, messsage) {\n    var socket = props.socket;\n    socket.emit(MESSAGE_SENT, {\n      chatId: chatId,\n      message: message\n    });\n  }\n\n  function updateActiveChat(activeChat) {\n    setActiveChat(activeChat);\n  }\n\n  return React.createElement(Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }, React.createElement(SideBar, {\n    logout: logout,\n    chats: chats,\n    user: user,\n    activeChat: activeChat,\n    setActiveChat: updateActiveChat,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"chat-room-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }, activeChat !== null ? React.createElement(\"div\", {\n    className: \"chat-room\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }, React.createElement(ChatHeading, {\n    name: activeChat.name,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }), React.createElement(Messages, {\n    messages: activeChat.messages,\n    user: user,\n    typingUsers: activeChat.typingUsers,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }), React.createElement(MessageInput, {\n    sendMessage: function sendMessage(message) {\n      _this.sendMessage(activeChat.id, message);\n    },\n    sendTyping: function sendTyping(isTyping) {\n      _this.sendTyping(activeChat.id, isTyping);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  })) : React.createElement(\"div\", {\n    className: \"chat-room choose\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  }, React.createElement(\"h3\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, \"Choose a chat!\")))));\n}\n\nexport default Chat;","map":{"version":3,"sources":["/Users/God/Desktop/github/Port/portfolio/client/src/pages/Chat/Chat.js"],"names":["React","Fragment","useEffect","SideBar","ChatHeading","Chat","props","useState","chat","setChat","activeChat","setActiveChat","loaded","setLoaded","socket","emit","COMMUNITY_CHAT","resetChat","addChat","reset","newChats","chats","setChats","messageEvent","MESSAGE_RECIEVED","id","typingEvent","TYPING","on","updateTypingChat","addMessageToChat","chatId","message","map","messages","push","isTyping","user","name","typingUsers","includes","typingUser","filter","u","sendTyping","messsage","MESSAGE_SENT","updateActiveChat","logout","sendMessage"],"mappings":"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","sourcesContent":["import React, { Fragment, useEffect } from 'react';\n\nimport SideBar from './SideBar';\nimport ChatHeading from './chatHeading';\n\nfunction Chat(props) {\n\n    const [chat, setChat] = useState([]);\n    const [activeChat, setActiveChat] = useState('');\n    const [loaded, setLoaded] = useState(false);\n\n    useEffect(() => {\n        if(!loaded) {\n            setLoaded(true);\n            const { socket } = props;\n            socket.emit(COMMUNITY_CHAT, resetChat);\n        }\n    })\n\n    function resetChat(chat) {\n        return addChat(chat, true);\n    }\n\n    function addChat(chat, reset) {\n        const { socket } = props;\n        const newChats = reset ? [chat] : [...chats, chat];\n        setChats({chats: newChats})\n        setActiveChat({activeChat:reset ? chat : activeChat});\n        const messageEvent = `${MESSAGE_RECIEVED}=${chat.id}`;\n        const typingEvent = `${TYPING}=${chat.id}`;\n        \n        socket.on(typingEvent, updateTypingChat(chat.id));\n        socket.on(messageEvent, addMessageToChat(chat.id));\n    } \n\n    function addMessageToChat(chatId) {\n        return message => {\n            let newChats = chats.map((chat) => {\n                if (chat.id === chatId) {\n                    chat.messages.push(message);\n                }\n                return chat;\n            });\n            setChats({chats: newChats});\n        };\n    }\n\n    function updateTypingChat(chatId) {\n        return ({isTyping, user}) => {\n            if(user !== props.user.name) {\n                let newChats = chats.map((chat) => {\n                    if(chat.id === chatId) {\n                        if(isTyping && !chat.typingUsers.includes(user)) {\n                            chat.typingUsers.push(user);\n                        } else if (!isTyping && chat.typingUser.includes(user)) {\n                            chat.typingUsers = chat.typingUsers.filter(u => u !== user)\n                        }\n                    }\n                    return chat;\n                })\n                setChats({chats: newChats});\n            }\n        }\n    }\n\n    function sendTyping(chatId, messsage) {\n        const { socket } = props;\n        socket.emit(MESSAGE_SENT, {chatId, message});\n    }\n\n    function updateActiveChat(activeChat) {\n        setActiveChat(activeChat);\n    }\n\n    return (\n        <Fragment>\n<div className=\"container\">\n\t\t\t\t<SideBar\n\t\t\t\t\tlogout={logout}\n\t\t\t\t\tchats={chats}\n\t\t\t\t\tuser={user}\n\t\t\t\t\tactiveChat={activeChat}\n\t\t\t\t\tsetActiveChat={updateActiveChat}\n\t\t\t\t\t/>\n\t\t\t\t<div className=\"chat-room-container\">\n\t\t\t\t\t{\n\t\t\t\t\t\tactiveChat !== null ? (\n\n\t\t\t\t\t\t\t<div className=\"chat-room\">\n\t\t\t\t\t\t\t\t<ChatHeading name={activeChat.name} />\n\t\t\t\t\t\t\t\t<Messages \n\t\t\t\t\t\t\t\t\tmessages={activeChat.messages}\n\t\t\t\t\t\t\t\t\tuser={user}\n\t\t\t\t\t\t\t\t\ttypingUsers={activeChat.typingUsers}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<MessageInput \n\t\t\t\t\t\t\t\t\tsendMessage={\n\t\t\t\t\t\t\t\t\t\t(message)=>{\n\t\t\t\t\t\t\t\t\t\t\tthis.sendMessage(activeChat.id, message)\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tsendTyping={\n\t\t\t\t\t\t\t\t\t\t(isTyping)=>{\n\t\t\t\t\t\t\t\t\t\t\tthis.sendTyping(activeChat.id, isTyping)\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t):\n\t\t\t\t\t\t<div className=\"chat-room choose\">\n\t\t\t\t\t\t\t<h3>Choose a chat!</h3>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t\t</div>\n\n\t\t\t</div>\n        </Fragment>\n    );\n}\n\nexport default Chat;"]},"metadata":{},"sourceType":"module"}