{"ast":null,"code":"import _slicedToArray from \"/Users/God/Desktop/github/Port/react-portfolio/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"/Users/God/Desktop/github/Port/react-portfolio/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/God/Desktop/github/Port/react-portfolio/client/src/components/Showcase/Social/MobileTimeline.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useContext, Fragment, useState, useEffect } from 'react';\nimport { AppContext } from '../../../context/AuthContext';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Paper, TextField, Collapse, List, ListItem, ListItemText, ListItemAvatar, Divider, Avatar, Icon, IconButton, CircularProgress, Typography } from '@material-ui/core';\nimport Moment from 'react-moment';\nimport GetMoment from 'moment';\nvar useStyles = makeStyles(function (theme) {\n  var _root, _input, _label;\n\n  return {\n    root: (_root = {}, _defineProperty(_root, theme.breakpoints.down('xs'), {\n      width: '90%'\n    }), _defineProperty(_root, \"paddingTop\", '10px'), _defineProperty(_root, \"paddingBottom\", '10px'), _defineProperty(_root, \"width\", '80%'), _defineProperty(_root, \"margin\", '0 auto'), _root),\n    listItem: {\n      marginTop: '20px',\n      display: 'flex',\n      justifyContent: 'flex-start',\n      flexWrap: 'wrap'\n    },\n    form: {\n      display: 'flex',\n      alignItems: 'center'\n    },\n    input: (_input = {}, _defineProperty(_input, theme.breakpoints.down('xs'), {\n      fontSize: '1rem' // padding: '5px 0px',\n\n    }), _defineProperty(_input, \"fontSize\", '1.5rem'), _input),\n    underline: {\n      '&:before': {\n        borderBottom: '1px solid rgb(129, 0, 206) !important'\n      },\n      '&:after': {\n        borderBottom: '2px solid rgb(255, 145, 71) !important'\n      },\n      '&:hover:before': {\n        borderBottom: '2px solid rgb(129, 0, 206) !important'\n      }\n    },\n    label: (_label = {}, _defineProperty(_label, theme.breakpoints.down('xs'), {\n      fontSize: '1rem'\n    }), _defineProperty(_label, \"fontSize\", '1.5rem'), _defineProperty(_label, '&.Mui-focused', {\n      color: 'rgb(255, 145, 71)'\n    }), _label),\n    Collapse: {\n      marginBottom: '20px'\n    },\n    avatar: {\n      height: 60,\n      width: 60,\n      marginRight: 10\n    },\n    iconButton: {\n      color: 'rgb(255, 145, 71)'\n    }\n  };\n});\n\nvar MobileTimeline = function MobileTimeline() {\n  var holder = useContext(AppContext);\n  var classes = useStyles();\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      commentInput = _useState2[0],\n      setCommentInput = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      newComment = _useState4[0],\n      setNewComment = _useState4[1];\n\n  var _useState5 = useState({}),\n      _useState6 = _slicedToArray(_useState5, 2),\n      storyIDs = _useState6[0],\n      setStoryIDs = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      stories = _useState8[0],\n      setStories = _useState8[1];\n\n  useEffect(function () {\n    if (!holder.auth) {\n      return;\n    }\n\n    fetch('/api/social/friendStories', {\n      method: 'POST',\n      body: JSON.stringify({\n        id: holder.auth.info\n      }),\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (result) {\n      var storyStorage = result;\n      var storyIDList = {};\n      holder.auth.info.authored_stories.map(function (story) {\n        storyIDList[story._id] = false;\n        storyStorage.push(story);\n      });\n      storyStorage.sort(function (a, b) {\n        return new Date(b.time) - new Date(a.time);\n      });\n      setStories(storyStorage);\n      setStoryIDs(storyIDList);\n    });\n  }, [holder.auth]);\n  useEffect(function () {\n    if (!newComment) {\n      return;\n    }\n\n    setNewComment('');\n    var storyStorage = [];\n    var storyIDList = {};\n    stories.map(function (story) {\n      if (story._id === newComment) {\n        storyStorage.push(story);\n        storyIDList[story._id] = true;\n      } else {\n        storyIDList[story._id] = false;\n        storyStorage.push(story);\n      }\n    });\n    storyStorage.sort(function (a, b) {\n      return new Date(b.time) - new Date(a.time);\n    });\n    setStoryIDs(storyIDList);\n    setStories(storyStorage);\n  }, [newComment]);\n\n  var handleDelete = function handleDelete(id) {\n    fetch('/api/social/deleteStory', {\n      method: 'POST',\n      body: JSON.stringify({\n        id: id\n      }),\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(function () {});\n  };\n\n  var handleCommentInput = function handleCommentInput(e) {\n    var value = e.target.value;\n    setCommentInput(value);\n  };\n\n  var handleCommentSubmit = function handleCommentSubmit(id, username) {\n    var time = GetMoment();\n    var data = {\n      time: time,\n      id: id,\n      userId: holder.auth._id,\n      comment: commentInput\n    };\n    var newStories = stories;\n    newStories.map(function (item, index) {\n      if (item._id === id) {\n        newStories[index].comments.push({\n          authored_by: {\n            info: '5d126d136f6f1085c8df8b81',\n            username: username\n          },\n          text: commentInput,\n          type: 'comment',\n          time: time\n        });\n      }\n    });\n    setStories(newStories);\n    setNewComment(id);\n    fetch('/api/social/newComment', {\n      method: 'POST',\n      body: JSON.stringify({\n        data: data\n      }),\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function () {\n      setCommentInput('');\n    });\n  };\n\n  var renderComments = function renderComments(comments) {\n    var commentList = [];\n\n    if (comments.length < 5) {\n      commentList = comments.slice(0, comments.length);\n    } else {\n      commentList = comments.slice(0, 5);\n    }\n\n    return commentList.map(function (comment, index) {\n      return React.createElement(Fragment, {\n        key: comment.time,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, React.createElement(Divider, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }), React.createElement(ListItem, {\n        key: index,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(ListItemText, {\n        primary: React.createElement(Typography, {\n          variant: holder.xs ? 'body1' : 'h6',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 185\n          },\n          __self: this\n        }, \"\".concat(comment.authored_by.username, \": \").concat(comment.text)),\n        secondary: React.createElement(Moment, {\n          date: comment.time,\n          format: 'dddd h:mm a',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 189\n          },\n          __self: this\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      })));\n    });\n  };\n\n  var expandComment = function expandComment(id) {\n    var newCommentState = !storyIDs[id];\n    setStoryIDs(_objectSpread({}, storyIDs, _defineProperty({}, id, newCommentState)));\n  };\n\n  var renderTimeline = function renderTimeline() {\n    if (stories) {\n      return stories.map(function (story) {\n        return React.createElement(Paper, {\n          key: story._id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 208\n          },\n          __self: this\n        }, React.createElement(ListItem, {\n          className: classes.listItem,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 210\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          style: {\n            width: '100%',\n            display: 'flex',\n            justifyContent: 'flex-start'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 212\n          },\n          __self: this\n        }, React.createElement(ListItemAvatar, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 214\n          },\n          __self: this\n        }, React.createElement(Avatar, {\n          className: classes.avatar,\n          alt: story._id,\n          src: \"https://media.licdn.com/dms/image/C5603AQHqTyUqMrqJZA/profile-displayphoto-shrink_200_200/0?e=1571270400&v=beta&t=Fwpkf09f2GNerYN2fC12EwcsHYivKOPTtRBhechPva4\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 215\n          },\n          __self: this\n        })), React.createElement(ListItemText, {\n          primary: React.createElement(Typography, {\n            variant: \"h6\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 224\n            },\n            __self: this\n          }, story.authored_by.username),\n          secondary: React.createElement(Typography, {\n            variant: \"body2\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 229\n            },\n            __self: this\n          }, React.createElement(Moment, {\n            date: story.time,\n            format: 'dddd h:mm a',\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 230\n            },\n            __self: this\n          })),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 222\n          },\n          __self: this\n        }), React.createElement(IconButton, {\n          onClick: function onClick() {\n            return handleDelete(story._id);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 235\n          },\n          __self: this\n        }, React.createElement(Icon, {\n          fontSize: holder.xs ? 'small' : 'large',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 236\n          },\n          __self: this\n        }, \"delete_outline\"))), React.createElement(Typography, {\n          variant: holder.xs ? 'body2' : 'h6',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 243\n          },\n          __self: this\n        }, story.text), React.createElement(IconButton, {\n          onClick: function onClick() {\n            return expandComment(story._id);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 249\n          },\n          __self: this\n        }, React.createElement(Icon, {\n          fontSize: holder.xs ? 'small' : 'large',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 250\n          },\n          __self: this\n        }, storyIDs ? storyIDs[story._id] ? 'expand_less' : 'expand_more' : false))), React.createElement(Collapse, {\n          className: classes.collapse,\n          in: storyIDs ? storyIDs[story._id] : false,\n          timeout: \"auto\",\n          unmountOnExit: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 258\n          },\n          __self: this\n        }, React.createElement(List, {\n          disablePadding: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 260\n          },\n          __self: this\n        }, renderComments(story.comments)), React.createElement(\"div\", {\n          className: classes.form,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 264\n          },\n          __self: this\n        }, React.createElement(TextField, {\n          InputProps: {\n            classes: {\n              underline: classes.underline,\n              input: classes.input\n            }\n          },\n          InputLabelProps: {\n            className: classes.label\n          },\n          multiline: true,\n          style: {\n            width: '100%'\n          },\n          name: \"123\",\n          value: commentInput,\n          variant: \"outlined\",\n          label: \"Add a comment\",\n          onChange: handleCommentInput,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 266\n          },\n          __self: this\n        }), React.createElement(IconButton, {\n          className: classes.iconButton,\n          onClick: function onClick() {\n            return handleCommentSubmit(story._id, story.authored_by.username);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 282\n          },\n          __self: this\n        }, React.createElement(Icon, {\n          fontSize: holder.xs ? 'small' : 'large',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 286\n          },\n          __self: this\n        }, \"add_circle\")))));\n      });\n    } else {\n      return React.createElement(CircularProgress, {\n        size: 100,\n        color: \"secondary\",\n        thickness: 2.6,\n        style: {\n          display: 'block',\n          margin: '40px auto 0px auto'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 296\n        },\n        __self: this\n      });\n    }\n  };\n\n  return React.createElement(List, {\n    className: classes.root,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300\n    },\n    __self: this\n  }, renderTimeline());\n};\n\nexport default MobileTimeline;","map":{"version":3,"sources":["/Users/God/Desktop/github/Port/react-portfolio/client/src/components/Showcase/Social/MobileTimeline.js"],"names":["React","useContext","Fragment","useState","useEffect","AppContext","makeStyles","Paper","TextField","Collapse","List","ListItem","ListItemText","ListItemAvatar","Divider","Avatar","Icon","IconButton","CircularProgress","Typography","Moment","GetMoment","useStyles","theme","root","breakpoints","down","width","listItem","marginTop","display","justifyContent","flexWrap","form","alignItems","input","fontSize","underline","borderBottom","label","color","marginBottom","avatar","height","marginRight","iconButton","MobileTimeline","holder","classes","commentInput","setCommentInput","newComment","setNewComment","storyIDs","setStoryIDs","stories","setStories","auth","fetch","method","body","JSON","stringify","id","info","headers","then","res","json","result","storyStorage","storyIDList","authored_stories","map","story","_id","push","sort","a","b","Date","time","handleDelete","handleCommentInput","e","value","target","handleCommentSubmit","username","data","userId","comment","newStories","item","index","comments","authored_by","text","type","renderComments","commentList","length","slice","xs","expandComment","newCommentState","renderTimeline","collapse","className","margin"],"mappings":"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","sourcesContent":["import React, { useContext, Fragment, useState, useEffect } from 'react';\n\nimport { AppContext } from '../../../context/AuthContext';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Paper, TextField, Collapse, List, ListItem, ListItemText, ListItemAvatar, Divider, Avatar, Icon, IconButton, CircularProgress, Typography} from '@material-ui/core';\n\nimport Moment from 'react-moment';\nimport GetMoment from 'moment';\n\nconst useStyles = makeStyles(theme => ({\n    root: {\n        [theme.breakpoints.down('xs')]: {\n            width: '90%',\n        },\n        paddingTop: '10px',\n        paddingBottom: '10px',\n        width: '80%',\n        margin: '0 auto',\n    },\n    listItem: {\n        marginTop: '20px',\n        display: 'flex',\n        justifyContent: 'flex-start',\n        flexWrap: 'wrap',\n    },\n    form: {\n        display: 'flex',\n        alignItems: 'center',\n    },\n    input: {\n        [theme.breakpoints.down('xs')]: {\n            fontSize: '1rem',\n            // padding: '5px 0px',\n        },\n        fontSize: '1.5rem',\n        // padding: '10px 0px',\n    },\n    underline: {\n        '&:before': {\n            borderBottom: '1px solid rgb(129, 0, 206) !important',\n        },\n        '&:after': {\n            borderBottom: '2px solid rgb(255, 145, 71) !important',\n        },\n        '&:hover:before': {\n            borderBottom: '2px solid rgb(129, 0, 206) !important',\n        },\n    },\n    label: {\n        [theme.breakpoints.down('xs')]: {\n            fontSize: '1rem',\n        },\n        fontSize: '1.5rem',\n        '&.Mui-focused': {\n            color: 'rgb(255, 145, 71)'\n        },\n    },\n    Collapse: {\n        marginBottom: '20px',\n    },\n    avatar: {\n        height: 60,\n        width: 60,\n        marginRight: 10,\n    },\n    iconButton: {\n        color: 'rgb(255, 145, 71)',\n    }\n}));\n\nconst MobileTimeline = () => {\n    const holder = useContext(AppContext);\n    const classes = useStyles();\n\n    const [commentInput, setCommentInput] = useState('');\n    const [newComment, setNewComment] = useState('');\n\n    const [storyIDs, setStoryIDs] = useState({});\n    const [stories, setStories] = useState('');\n\n    useEffect(() => {\n        if (!holder.auth) { return }\n        fetch('/api/social/friendStories', {\n            method: 'POST',\n            body: JSON.stringify({ id: holder.auth.info }),\n            headers: { 'Content-Type': 'application/json' }\n        })\n            .then(res => res.json())\n            .then((result) => {\n                let storyStorage = result;\n                let storyIDList = {};\n                holder.auth.info.authored_stories.map((story) => {\n                    storyIDList[story._id] = false;\n                    storyStorage.push(story);\n                });\n                storyStorage.sort((a, b) => {\n                    return new Date(b.time) - new Date(a.time);\n                });\n                setStories(storyStorage);\n                setStoryIDs(storyIDList);\n            });\n    }, [holder.auth]);\n\n    useEffect(() => {\n        if (!newComment) { return }\n            setNewComment('');\n            let storyStorage = [];\n            let storyIDList = {};\n            stories.map((story) => {\n                if (story._id === newComment) {\n                    storyStorage.push(story); \n                    storyIDList[story._id] = true\n                } else {\n                    storyIDList[story._id] = false\n                    storyStorage.push(story); \n                }\n            });\n            storyStorage.sort((a, b) => {\n                return new Date(b.time) - new Date(a.time);\n            });\n            setStoryIDs(storyIDList);\n            setStories(storyStorage);\n    }, [newComment]);\n    \n    const handleDelete = (id) => {\n        fetch('/api/social/deleteStory', {\n            method: 'POST',\n            body: JSON.stringify({ id }),\n            headers: { 'Content-Type': 'application/json' }\n        })\n        .then(() => {});\n    };\n\n    const handleCommentInput = (e) => {\n        const { value } = e.target;\n        setCommentInput(value);\n    };\n\n    const handleCommentSubmit = (id, username) => {\n        const time = GetMoment(); \n        const data = {\n            time,\n            id,\n            userId: holder.auth._id,\n            comment: commentInput,\n        };\n        let newStories = stories;\n        newStories.map((item, index) => {    \n            if(item._id === id) {\n                newStories[index].comments.push({\n                    authored_by: { info: '5d126d136f6f1085c8df8b81', username },\n                    text: commentInput,\n                    type: 'comment',\n                    time,\n                });\n            }\n        });\n        setStories(newStories);\n        setNewComment(id);\n        fetch('/api/social/newComment', {\n            method: 'POST',\n            body: JSON.stringify({ data }),\n            headers: { 'Content-Type': 'application/json' }\n        })\n            .then(res => res.json())\n            .then(() => {\n                setCommentInput('');\n            });\n    };\n\n    const renderComments = (comments) => {\n        let commentList = [];\n        if (comments.length < 5) { commentList = comments.slice(0, comments.length) }\n        else { commentList = comments.slice(0, 5) }\n        return (\n            commentList.map((comment, index) => {\n                return (  \n                    <Fragment key={comment.time}>\n\n                        <Divider />\n\n                        <ListItem key={index}>\n                            <ListItemText primary={\n                                <Typography variant={holder.xs ? 'body1' : 'h6'}>\n                                    {`${comment.authored_by.username}: ${comment.text}`}\n                                </Typography>\n                                }\n                                secondary={<Moment date={comment.time} format={'dddd h:mm a'} />} />\n                        </ListItem>\n\n                    </Fragment>\n                );\n            })\n        );\n    };\n\n    const expandComment = (id) => {\n        const newCommentState = !storyIDs[id];\n        setStoryIDs({ ...storyIDs, [id]: newCommentState });\n    };\n\n    const renderTimeline = () => {\n        if (stories) {\n            return (\n                stories.map((story) => (\n\n                    <Paper key={story._id}>\n\n                        <ListItem className={classes.listItem}>\n\n                            <div style={{ width: '100%', display: 'flex', justifyContent: 'flex-start' }}>\n\n                                <ListItemAvatar>\n                                    <Avatar\n                                        className={classes.avatar}\n                                        alt={story._id}\n                                        src={`https://media.licdn.com/dms/image/C5603AQHqTyUqMrqJZA/profile-displayphoto-shrink_200_200/0?e=1571270400&v=beta&t=Fwpkf09f2GNerYN2fC12EwcsHYivKOPTtRBhechPva4`}\n                                    />\n                                </ListItemAvatar>\n\n                                <ListItemText\n                                    primary={\n                                        <Typography variant='h6'>\n                                            {story.authored_by.username}\n                                        </Typography>\n                                    }\n                                    secondary={\n                                        <Typography variant='body2'>\n                                            <Moment date={story.time} format={'dddd h:mm a'} />\n                                        </Typography>\n                                    }\n                                />\n\n                                <IconButton onClick={() => handleDelete(story._id)}>\n                                    <Icon fontSize={holder.xs ? 'small' : 'large'}>\n                                        delete_outline\n                                    </Icon>\n                                </IconButton>\n                                \n                            </div>\n\n                            <Typography variant={holder.xs ? 'body2' : 'h6'}>\n                                {story.text}\n                            </Typography>\n\n                            \n                            \n                            <IconButton onClick={() => expandComment(story._id)}>\n                                <Icon fontSize={holder.xs ? 'small' : 'large'}>\n                                    {storyIDs ? storyIDs[story._id] ? 'expand_less' : 'expand_more' : false}\n                                </Icon>\n                            </IconButton>\n\n\n                        </ListItem>\n\n                        <Collapse className={classes.collapse} in={storyIDs ? storyIDs[story._id] : false} timeout=\"auto\" unmountOnExit>\n                            \n                            <List disablePadding>\n                                {renderComments(story.comments)}\n                            </List>\n\n                            <div className={classes.form}>\n\n                                <TextField\n                                    InputProps={{ classes: {\n                                        underline: classes.underline,\n                                        input: classes.input,\n                                        }\n                                    }}\n                                    InputLabelProps={{ className: classes.label }}\n                                    multiline                                \n                                    style={{ width: '100%' }}\n                                    name='123'\n                                    value={commentInput}\n                                    variant=\"outlined\"\n                                    label=\"Add a comment\"\n                                    onChange={handleCommentInput}\n                                />\n\n                                <IconButton\n                                    className={classes.iconButton}\n                                    onClick={() => handleCommentSubmit(story._id, story.authored_by.username)}\n                                >\n                                    <Icon fontSize={holder.xs ? 'small' : 'large'}>add_circle</Icon>\n                                </IconButton>\n\n                            </div>\n\n                        </Collapse>\n\n                    </Paper>\n                ))\n            );          \n        } else { return <CircularProgress size={100} color=\"secondary\" thickness={2.6} style={{display: 'block', margin: '40px auto 0px auto'}}  /> }\n    }\n\n    return (\n        <List className={classes.root}>\n            {renderTimeline()}\n        </List>\n    );\n};\n\nexport default MobileTimeline;\n"]},"metadata":{},"sourceType":"module"}